!function e(t,i,a){function n(s,l){if(!i[s]){if(!t[s]){var r="function"==typeof require&&require;if(!l&&r)return r(s,!0);if(o)return o(s,!0);throw new Error("Cannot find module '"+s+"'")}var p=i[s]={exports:{}};t[s][0].call(p.exports,function(e){var i=t[s][1][e];return n(i?i:e)},p,p.exports,e,t,i,a)}return i[s].exports}for(var o="function"==typeof require&&require,s=0;s<a.length;s++)n(a[s]);return n}({1:[function(e,t,i){"use strict";var a,n,o,s=function(e,t,i,s,l){e=e,a=e.game,n=e.add,o=e.physics,Phaser.Sprite.call(this,a,t,i,s,l),n.existing(this),this.animations.add("explode",[1,2,3,4,5,6],10,!1).killOnComplete=!0,o.arcade.enable(this),this.scale.x=a.init.pixelScale,this.scale.y=a.init.pixelScale};s.prototype=Object.create(Phaser.Sprite.prototype),s.prototype.constructor=s,s.prototype.moveUp=function(){this.accelerate(),n.tween(this).to({y:a.init.lanes()[0]},300,Phaser.Easing.Sinusoidal.InOut,!0,0)},s.prototype.moveDown=function(){this.accelerate(),n.tween(this).to({y:a.init.lanes()[1]},300,Phaser.Easing.Sinusoidal.InOut,!0,0)},s.prototype.accelerate=function(){this.body.velocity.x=a.init.carPedal()},t.exports=s},{}],2:[function(e,t,i){"use strict";!function(){var t=e("./init.js"),i=e("./utils.js"),a=e("./states/boot.js"),n=e("./states/preloader.js"),o=e("./states/menu.js"),s=e("./states/game.js"),l=e("./states/win.js"),r=window.Phaser?window.Phaser:void 0;if(void 0===r)throw new Error("Phaser didn't load correctly. Please reload the website.");var p=new r.Game(t.gameWidth(),t.gameHeight(),r.CANVAS,"gameDiv",null,!1,!1);p.utils=i,p.init=t,p.state.add("Boot",a),p.state.add("Preloader",n),p.state.add("Menu",o),p.state.add("Game",s),p.state.add("Win",l),p.state.start("Boot")}()},{"./init.js":3,"./states/boot.js":4,"./states/game.js":5,"./states/menu.js":6,"./states/preloader.js":7,"./states/win.js":8,"./utils.js":9}],3:[function(e,t,i){"use strict";t.exports={pixelScale:10,gameSpeed:.5,gameInit:!1,gameOver:!1,enemySpeed:300,ajax:!0,score:0,levelIndex:0,nextLevel:[1,3,5],win:9,gameId:"CarCrash",highscore:0,level:0,gameSpeedSlower:function(){return this.gameSpeed/2},gameSpeedSlowest:function(){return this.gameSpeed/10},lanes:function(){var e=36*this.pixelScale,t=42*this.pixelScale,i=40.5*this.pixelScale;return[e,t,i]},gravity:function(){return-35*this.pixelScale},carPedal:function(){return 10*this.pixelScale},gameWidth:function(){return 30*this.pixelScale},gameHeight:function(){return 60*this.pixelScale}}},{}],4:[function(e,t,i){"use strict";var a,n,o,s,l=function(){};l.prototype={preload:function(){a=this,o=a.load,o.image("preloader","assets/preloader.png"),o.image("fblogo","assets/fblogow.png")},create:function(){n=a.game,s=a.scale,a.input.maxPointers=1,n.device.desktop?(s.pageAlignHorizontally=!0,s.pageAlignVertically=!0,s.refresh()):(s.scaleMode=Phaser.ScaleManager.SHOW_ALL,s.minWidth=window.innerHeight/1.5,s.minHeight=window.innerHeight,s.maxWidth=window.innerHeight/1.5,s.maxHeight=window.innerHeight,s.forceLandscape=!0,s.pageAlignHorizontally=!0),a.state.start("Preloader")}},t.exports=l},{}],5:[function(e,t,i){"use strict";var a,n,o,s,l,r,p,c,g,d,u,m,h,f,x,y,S,v,w,b,P=e("../entities/player.js"),j=function(){};j.prototype={create:function(){a=this,n=a.input.keyboard,o=a.game,s=a.add,l=a.physics,l.startSystem(Phaser.Physics.ARCADE),r=n.createCursorKeys(),p=n.addKey(Phaser.Keyboard.ENTER),o.stage.backgroundColor=16732224,c=s.sprite(0,0,"bground"),c.scale.setTo(this.game.init.pixelScale,this.game.init.pixelScale),g=s.tileSprite(0,0,30,60*o.init.pixelScale,"lv1"),g.scale.setTo(this.game.init.pixelScale,this.game.init.pixelScale),d=s.tileSprite(0,45*o.init.pixelScale,30,15,"floor1"),d.scale.setTo(this.game.init.pixelScale,this.game.init.pixelScale),u=s.tileSprite(0,34*o.init.pixelScale,30,13,"road"),u.scale.setTo(this.game.init.pixelScale,this.game.init.pixelScale),m=s.group(),m.enableBody=!0,l.arcade.enable(m);for(var e=0;2>e;e++)h=m.create(-9*o.init.pixelScale,o.init.lanes()[e],"truck"),h.scale.setTo(o.init.pixelScale,o.init.pixelScale);x=s.group(),x.enableBody=!0,l.arcade.enable(x);for(var e=0;2>e;e++)y=x.create(30*o.init.pixelScale*(1+e),o.init.lanes()[e],"enemy"),y.scale.setTo(o.init.pixelScale,o.init.pixelScale),y.animations.add("explodeRed",[1,2,3,4,5,6],10,!1).killOnComplete=!0;f=new P(a,5*o.init.pixelScale,36*o.init.pixelScale,"car"),S=s.bitmapText(0,5*o.init.pixelScale,"litto",0,o.init.pixelScale),v=s.sprite(5*o.init.pixelScale,15*o.init.pixelScale,"over"),v.scale.setTo(this.game.init.pixelScale,this.game.init.pixelScale),v.alpha=0,w=s.button(9*o.init.pixelScale,35*o.init.pixelScale,"retry"),w.scale.setTo(this.game.init.pixelScale,this.game.init.pixelScale),w.alpha=0,b=s.audio("themeSong"),a.sound.setDecodedCallback(b,a.startSong,a)},update:function(){a.animateBackground(),o.init.gameInit===!1&&(r.down.isDown||r.up.isDown||o.input.activePointer.isDown)&&a.gameStart(),o.init.nextLevel[o.init.levelIndex]===o.init.score&&a.newLevelStart(),o.init.gameOver===!0&&o.init.ajax===!0&&a.gameOver(),o.init.score===o.init.win&&a.gameWin(),!(r.up.isDown||o.input.activePointer.isDown&&o.input.activePointer.position.y<o.init.lanes()[2])||f.y!==o.init.lanes()[0]&&f.y!==o.init.lanes()[1]?!(r.down.isDown||o.input.activePointer.isDown&&o.input.activePointer.position.y>o.init.lanes()[2])||f.y!==o.init.lanes()[0]&&f.y!==o.init.lanes()[1]||f.moveDown():f.moveUp(),a.enemyScoreUpdate(),l.arcade.overlap(f,x,a.playerEnemyCollision),l.arcade.overlap(f,m,a.playerTruckCollision),l.arcade.overlap(m,x,a.enemyTruckCollision)},render:function(){}},j.prototype.gameStart=function(){f.body.gravity.x=o.init.gravity(),x.setAll("body.velocity.x",-o.init.enemySpeed),o.init.gameInit=!0},j.prototype.gameOver=function(){o.init.score>o.init.highscore&&(o.init.highscore=o.init.score),o.utils.ajax.loose(o),o.init.ajax=!1,b.stop(),o.utils.fadeOut(c,0,a),o.utils.fadeOut(g,0,a),o.utils.fadeOut(d,0,a),o.utils.fadeIn(v,0,a),o.utils.fadeIn(w,0,a),o.time.events.add(.5*Phaser.Timer.SECOND,function(){w.events.onInputDown.addOnce(a.gameRetry,a),p.onDown.add(a.gameRetry,a)})},j.prototype.gameRetry=function(){o.utils.ajax.retry(o),o.init.ajax=!1,o.init.gameInit=!1,o.init.gameOver=!1,o.init.score=0,o.init.levelIndex=0,o.init.ajax=!0,a.state.restart(!0,!1)},j.prototype.gameWin=function(){o.utils.ajax.win(o),o.init.ajax=!1,b.stop(),a.state.start("Win")},j.prototype.playerEnemyCollision=function(e,t){e.animations.play("explode"),t.animations.play("explodeRed"),o.init.gameOver=!0},j.prototype.playerTruckCollision=function(e,t){e.accelerate(),e.animations.play("explode"),t.body.velocity.x=o.init.enemySpeed,o.init.gameOver=!0},j.prototype.enemyTruckCollision=function(e,t){e.x>=0&&(t.body.velocity.x=o.init.carPedal(),t.animations.play("explodeRed"))},j.prototype.ajaxPut=function(e,t){},j.prototype.ajaxGet=function(e){},j.prototype.animateBackground=function(){o.utils.tileAnimation(g,o.init.gameSpeedSlowest()),o.utils.tileAnimation(d,o.init.gameSpeed),o.utils.tileAnimation(u,o.init.gameSpeedSlower())},j.prototype.newLevelStart=function(){c.frame=o.init.levelIndex+1,o.utils.fadeOut(g,0,a),o.utils.fadeOut(d,0,a),o.init.levelIndex++,o.time.events.add(1*Phaser.Timer.SECOND,a.newLevelEnd,a)},j.prototype.newLevelEnd=function(){o.init.gameOver===!1&&(g.loadTexture("lv"+(o.init.levelIndex+1)),d.loadTexture("floor"+(o.init.levelIndex+1)),o.utils.fadeIn(g,0,a),o.utils.fadeIn(d,0,a))},j.prototype.enemyScoreUpdate=function(){x.forEach(function(e){e.x<=-5*o.init.pixelScale&&o.init.gameOver===!1&&(e.y=o.init.lanes()[0]+(o.init.lanes()[1]-o.init.lanes()[0])*o.rnd.integerInRange(0,1),e.x=60*o.init.pixelScale,o.init.score++)}),S.text=o.init.score,S.x=(30*o.init.pixelScale-S.width)/2},j.prototype.checkHighscore=function(e){o.init.score>e&&console.log("new record!")},j.prototype.startSong=function(){b.loopFull(.5)},t.exports=j},{"../entities/player.js":1}],6:[function(e,t,i){"use strict";var a,n,o,s,l,r,p,c,g=function(){};g.prototype={create:function(){a=this,n=a.game,o=a.add,a.stage.backgroundColor=3289907,s=o.tileSprite(0,0,30,60,"menuBg"),a.scaleSprite(s),s.inputEnabled=!0,p=o.audio("themeSong"),a.sound.setDecodedCallback(p,a.startSong,a),l=o.tileSprite(0,15*n.init.pixelScale,30,5,"title"),a.scaleSprite(l),l.alpha=0,r=o.tileSprite(n.init.gameWidth()-70,n.init.gameHeight()-32,30,11,"fblogo"),r.scale.x=2,r.scale.y=2,c=n.input.keyboard.addKey(Phaser.Keyboard.ENTER),s.events.onInputDown.addOnce(a.startGame,a),c.onDown.add(a.startGame,a)},update:function(){a.game.utils.fadeIn(l,120,this)}},g.prototype.scaleSprite=function(e){e.scale.x=this.game.init.pixelScale,e.scale.y=this.game.init.pixelScale},g.prototype.startGame=function(){p.stop(),a.state.start("Game")},g.prototype.startSong=function(){p.loopFull(.5)},t.exports=g},{}],7:[function(e,t,i){"use strict";var a,n,o,s,l,r,p=function(){};p.prototype={preload:function(){a=this,o=a.load,a.setProgressLogo(),o.image("menuBg","assets/menu.png"),o.image("title","assets/title.png"),o.spritesheet("bground","assets/backgrounds.png",30,60,4),o.image("lv1","assets/lv1.png"),o.image("lv2","assets/lv2.png"),o.image("lv3","assets/lv3.png"),o.image("lv4","assets/lv4.png"),o.image("road","assets/road.png"),o.image("floor1","assets/floor1.png"),o.image("floor2","assets/floor2.png"),o.image("floor3","assets/floor3.png"),o.image("floor4","assets/floor4.png"),o.spritesheet("car","assets/car.png",5,3,8),o.spritesheet("enemy","assets/enemy.png",5,3,8),o.image("truck","assets/truck.png"),o.bitmapFont("litto","assets/litto.png","assets/litto.xml"),o.image("over","assets/over.png"),o.image("retry","assets/retry.png"),o.audio("themeSong","assets/themesong.m4a"),o.image("winback","assets/winback.png"),o.image("wintitle","assets/wintitle.png"),o.onLoadComplete.add(a.onLoadComplete,a)}},p.prototype.setProgressLogo=function(){n=a.game,s=a.add,l=s.tileSprite(n.init.gameWidth()/2-90,n.init.gameHeight()/2-90,30,11,"fblogo"),l.scale.x=6,l.scale.y=6,r=s.sprite(n.init.gameWidth()/2-110,n.init.gameHeight()/2,"preloader"),r.cropEnabled=!1,o.setPreloadSprite(r)},p.prototype.onLoadComplete=function(){a.state.start("Menu")},t.exports=p},{}],8:[function(e,t,i){"use strict";var a=function(){};a.prototype={create:function(){this.stage.backgroundColor=3289907,this.menu=this.add.tileSprite(0,0,30,60,"winback"),this.scaleSprite(this.menu),this.menu.inputEnabled=!0,this.title=this.add.tileSprite(0,15*this.game.init.pixelScale,30,5,"wintitle"),this.scaleSprite(this.title),this.title.alpha=0,this.fblogo=this.add.tileSprite(this.game.init.gameWidth()-70,this.game.init.gameHeight()-32,30,11,"fblogo"),this.fblogo.scale.x=2,this.fblogo.scale.y=2},update:function(){this.game.utils.fadeIn(this.title,120,this)}},a.prototype.scaleSprite=function(e){e.scale.x=this.game.init.pixelScale,e.scale.y=this.game.init.pixelScale},t.exports=a},{}],9:[function(e,t,i){"use strict";var a={fadeOut:function(e,t,i){i.game.add.tween(e).to({alpha:0},t,Phaser.Easing.Sinusoidal.InOut,!0,0)},fadeIn:function(e,t,i){i.game.add.tween(e).to({alpha:1},t,Phaser.Easing.Sinusoidal.InOut,!0,0)},tileAnimation:function(e,t){e.tilePosition.x-=t}};a.ajax={get:function(e,t){var i=new XMLHttpRequest;i.open("GET",e,!0),i.onload=function(){if(i.status>=200&&i.status<400){var e=JSON.parse(i.responseText);console.log("getData",e);for(var a=0;a<e.length;a++)t.init.score>e[a].highscore.score&&console.log("new highscore table record!")}else console.log("We reached our target server, but it returned an error.")},i.onerror=function(){console.log("There was a connection error of some sort.")},i.send()},put:function(e,t){var i=new XMLHttpRequest;i.open("PUT",t,!0),i.setRequestHeader("Content-Type","application/json; charset=UTF-8"),i.send(JSON.stringify(e))},loose:function(e){var t={game:e.init.gameId,highscore:e.init.highscore,level:e.init.level};this.put(t,"/api/stats"),this.get("/api/highscores",e),console.log("loosedata",t)},retry:function(e){var t={game:e.init.gameId,plays:1};this.put(t,"/api/stats"),console.log("retryData",t)},win:function(e){var t={game:e.init.gameId,wins:1};this.put(t,"/api/stats"),console.log("winData",t)}},t.exports=a},{}]},{},[2]);