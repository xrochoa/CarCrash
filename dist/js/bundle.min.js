!function e(t,i,a){function n(o,r){if(!i[o]){if(!t[o]){var l="function"==typeof require&&require;if(!r&&l)return l(o,!0);if(s)return s(o,!0);throw new Error("Cannot find module '"+o+"'")}var c=i[o]={exports:{}};t[o][0].call(c.exports,function(e){var i=t[o][1][e];return n(i?i:e)},c,c.exports,e,t,i,a)}return i[o].exports}for(var s="function"==typeof require&&require,o=0;o<a.length;o++)n(a[o]);return n}({1:[function(e,t,i){"use strict";!function(){var t=e("./init.js"),i=e("./utils.js"),a=e("./states/boot.js"),n=e("./states/preloader.js"),s=e("./states/menu.js"),o=e("./states/game.js"),r=e("./states/win.js"),l=window.Phaser?window.Phaser:void 0;if(void 0===l)throw new Error("Phaser didn't load correctly. Please reload the website.");var c=new l.Game(t.gameWidth(),t.gameHeight(),l.CANVAS,"gameDiv",null,!1,!1);c.utils=i,c.init=t,c.state.add("Boot",a),c.state.add("Preloader",n),c.state.add("Menu",s),c.state.add("Game",o),c.state.add("Win",r),c.state.start("Boot")}()},{"./init.js":2,"./states/boot.js":3,"./states/game.js":4,"./states/menu.js":5,"./states/preloader.js":6,"./states/win.js":7,"./utils.js":8}],2:[function(e,t,i){"use strict";t.exports={pixelScale:10,gameSpeed:.5,gameInit:!1,gameOver:!1,enemySpeed:300,ajax:!0,score:0,levelIndex:0,nextLevel:[10,100,1e3],win:1e4,gameId:"CarCrash",highscore:0,level:0,gameSpeedSlower:function(){return this.gameSpeed/2},gameSpeedSlowest:function(){return this.gameSpeed/10},lanes:function(){var e=36*this.pixelScale,t=42*this.pixelScale,i=40.5*this.pixelScale;return[e,t,i]},gravity:function(){return-35*this.pixelScale},carPedal:function(){return 10*this.pixelScale},gameWidth:function(){return 30*this.pixelScale},gameHeight:function(){return 60*this.pixelScale}}},{}],3:[function(e,t,i){"use strict";var a,n,s,o,r=function(){};r.prototype={preload:function(){a=this,s=a.load,s.image("preloader","assets/preloader.png"),s.image("fblogo","assets/fblogow.png")},create:function(){n=a.game,o=a.scale,a.input.maxPointers=1,n.device.desktop?(o.pageAlignHorizontally=!0,o.pageAlignVertically=!0,o.refresh()):(o.scaleMode=Phaser.ScaleManager.SHOW_ALL,o.minWidth=480,o.minHeight=260,o.maxWidth=640,o.maxHeight=480,o.forceLandscape=!0,o.pageAlignHorizontally=!0),a.state.start("Preloader")}},t.exports=r},{}],4:[function(e,t,i){"use strict";var a,n,s,o,r,l,c,p,d,u,g,m,f,h,x,S,v,y,w,b,P,I=function(){};I.prototype={create:function(){a=this,n=a.input.keyboard,s=a.game,o=a.add,r=a.physics,console.log(this),r.startSystem(Phaser.Physics.ARCADE),l=n.createCursorKeys(),c=n.addKey(Phaser.Keyboard.ENTER),s.stage.backgroundColor=16732224,p=o.sprite(0,0,"bground"),a.scaleSprite(p),d=o.tileSprite(0,0,30,60*s.init.pixelScale,"lv1"),a.scaleSprite(d),u=o.tileSprite(0,45*s.init.pixelScale,30,15,"floor1"),a.scaleSprite(u),g=o.tileSprite(0,34*s.init.pixelScale,30,13,"road"),a.scaleSprite(g),m=o.group(),m.enableBody=!0,r.arcade.enable(m);for(var e=0;2>e;e++)f=m.create(-9*s.init.pixelScale,s.init.lanes()[e],"truck"),a.scaleSprite(f);h=o.sprite(5*s.init.pixelScale,36*s.init.pixelScale,"car"),h.animations.add("explode",[1,2,3,4,5,6],10,!1).killOnComplete=!0,a.scaleSprite(h),r.arcade.enable(h),x=o.group(),x.enableBody=!0,r.arcade.enable(x);for(var e=0;2>e;e++)S=x.create(30*s.init.pixelScale*(1+e),s.init.lanes()[e],"enemy"),S.animations.add("explodeRed",[1,2,3,4,5,6],10,!1).killOnComplete=!0,a.scaleSprite(S);v=o.bitmapText(0,5*s.init.pixelScale,"litto",0,s.init.pixelScale),y=o.sprite(5*s.init.pixelScale,15*s.init.pixelScale,"over"),a.scaleSprite(y),y.alpha=0,w=o.button(9*s.init.pixelScale,35*s.init.pixelScale,"retry"),a.scaleSprite(w),w.alpha=0,b=o.audio("themeSong"),a.sound.setDecodedCallback(b,a.startSong,a)},update:function(){s.utils.tileAnimation(d,s.init.gameSpeedSlowest()),s.utils.tileAnimation(u,s.init.gameSpeed),s.utils.tileAnimation(g,s.init.gameSpeedSlower()),s.init.gameInit===!1&&(l.down.isDown||l.up.isDown||s.input.activePointer.isDown)&&a.gameStart(),s.init.nextLevel[s.init.levelIndex]===s.init.score&&(p.frame=s.init.levelIndex+1,s.utils.fadeOut(d,0,a),s.utils.fadeOut(u,0,a),s.init.levelIndex++,s.time.events.add(1*Phaser.Timer.SECOND,a.fadeInNewLevel,a)),s.init.score===s.init.win&&(P={game:s.init.gameId,wins:1},a.ajaxPut(P,"/api/stats"),b.stop(),a.state.start("Win")),s.init.gameOver===!0&&s.init.ajax===!0&&(b.stop(),a.gameOver()),!(l.up.isDown||s.input.activePointer.isDown&&s.input.activePointer.position.y<s.init.lanes()[2])||h.y!==s.init.lanes()[0]&&h.y!==s.init.lanes()[1]?!(l.down.isDown||s.input.activePointer.isDown&&s.input.activePointer.position.y>s.init.lanes()[2])||h.y!==s.init.lanes()[0]&&h.y!==s.init.lanes()[1]||a.carMoveDown():a.carMoveUp(),x.forEach(function(e){e.x<=-5*s.init.pixelScale&&s.init.gameOver===!1&&(e.y=s.init.lanes()[0]+(s.init.lanes()[1]-s.init.lanes()[0])*s.rnd.integerInRange(0,1),e.x=60*s.init.pixelScale,s.init.score++)}),v.text=s.init.score,v.x=(30*s.init.pixelScale-v.width)/2,r.arcade.overlap(h,m,a.truckExplode,null,a),r.arcade.overlap(h,x,a.carExplode,null,a),r.arcade.overlap(f,x,a.enemyExplode,null,a)},render:function(){},carMoveUp:function(){a.carAccelerates(h),o.tween(h).to({y:s.init.lanes()[0]},300,Phaser.Easing.Sinusoidal.InOut,!0,0)},carMoveDown:function(){a.carAccelerates(h),o.tween(h).to({y:s.init.lanes()[1]},300,Phaser.Easing.Sinusoidal.InOut,!0,0)},carExplode:function(e,t){e.animations.play("explode"),t.animations.play("explodeRed"),s.init.gameOver=!0},truckExplode:function(e,t){a.carAccelerates(e),e.animations.play("explode"),t.body.velocity.x=s.init.enemySpeed,s.init.gameOver=!0},enemyExplode:function(e,t){e.body.velocity.x===s.init.enemySpeed&&(t.animations.play("explodeRed"),a.carAccelerates(t))},scaleSprite:function(e){e.scale.x=this.game.init.pixelScale,e.scale.y=this.game.init.pixelScale},gameStart:function(){h.body.gravity.x=s.init.gravity(),x.setAll("body.velocity.x",-s.init.enemySpeed),s.init.gameInit=!0},gameOver:function(){s.init.score>s.init.highscore&&(s.init.highscore=s.init.score);var e={game:s.init.gameId,highscore:s.init.highscore,level:s.init.level};a.ajaxPut(e,"/api/stats"),a.ajaxGet("/api/highscores"),s.utils.fadeOut(p,0,a),s.utils.fadeOut(d,0,a),s.utils.fadeOut(u,0,a),s.utils.fadeIn(y,0,a),s.utils.fadeIn(w,0,a),s.time.events.add(.5*Phaser.Timer.SECOND,a.retryEnableInput,a)},retryEnableInput:function(){w.events.onInputDown.addOnce(a.gameReload,a),c.onDown.add(a.gameReload,a)},gameReload:function(){var e={game:s.init.gameId,plays:1};a.ajaxPut(e,"/api/stats"),s.init.gameInit=!1,s.init.gameOver=!1,s.init.score=0,s.init.levelIndex=0,s.init.ajax=!0,a.state.restart(!0,!1)},carAccelerates:function(e){e.body.velocity.x=s.init.carPedal()},ajaxPut:function(e,t){var i=new XMLHttpRequest;i.open("PUT",t,!0),i.setRequestHeader("Content-Type","application/json; charset=UTF-8"),i.send(JSON.stringify(e)),s.init.ajax=!1},ajaxGet:function(e){var t=new XMLHttpRequest;t.open("GET",e,!0),t.onload=function(){if(t.status>=200&&t.status<400)for(var e=JSON.parse(t.responseText),i=0;i<e.length;i++)a.checkHighscore(e[i].highscore.score);else console.log("We reached our target server, but it returned an error.")},t.onerror=function(){console.log("There was a connection error of some sort.")},t.send()},fadeInNewLevel:function(){s.init.gameOver===!1&&(d.loadTexture("lv"+(s.init.levelIndex+1)),u.loadTexture("floor"+(s.init.levelIndex+1)),s.utils.fadeIn(d,0,a),s.utils.fadeIn(u,0,a))},checkHighscore:function(e){s.init.score>e&&console.log("new record!")}},I.prototype.startSong=function(){b.loopFull(.5)},t.exports=I},{}],5:[function(e,t,i){"use strict";var a,n,s,o,r,l,c,p,d=function(){};d.prototype={create:function(){a=this,n=a.game,s=a.add,a.stage.backgroundColor=3289907,o=s.tileSprite(0,0,30,60,"menuBg"),a.scaleSprite(o),o.inputEnabled=!0,c=s.audio("themeSong"),a.sound.setDecodedCallback(c,a.startSong,a),r=s.tileSprite(0,15*n.init.pixelScale,30,5,"title"),a.scaleSprite(r),r.alpha=0,l=s.tileSprite(n.init.gameWidth()-70,n.init.gameHeight()-32,30,11,"fblogo"),l.scale.x=2,l.scale.y=2,p=n.input.keyboard.addKey(Phaser.Keyboard.ENTER),o.events.onInputDown.addOnce(a.startGame,a),p.onDown.add(a.startGame,a)},update:function(){a.game.utils.fadeIn(r,120,this)}},d.prototype.scaleSprite=function(e){e.scale.x=this.game.init.pixelScale,e.scale.y=this.game.init.pixelScale},d.prototype.startGame=function(){c.stop(),a.state.start("Game")},d.prototype.startSong=function(){c.loopFull(.5)},t.exports=d},{}],6:[function(e,t,i){"use strict";var a,n,s,o,r,l,c=function(){};c.prototype={preload:function(){a=this,s=a.load,a.setProgressLogo(),s.image("menuBg","assets/menu.png"),s.image("title","assets/title.png"),s.spritesheet("bground","assets/backgrounds.png",30,60,4),s.image("lv1","assets/lv1.png"),s.image("lv2","assets/lv2.png"),s.image("lv3","assets/lv3.png"),s.image("lv4","assets/lv4.png"),s.image("road","assets/road.png"),s.image("floor1","assets/floor1.png"),s.image("floor2","assets/floor2.png"),s.image("floor3","assets/floor3.png"),s.image("floor4","assets/floor4.png"),s.spritesheet("car","assets/car.png",5,3,8),s.spritesheet("enemy","assets/enemy.png",5,3,8),s.image("truck","assets/truck.png"),s.bitmapFont("litto","assets/litto.png","assets/litto.xml"),s.image("over","assets/over.png"),s.image("retry","assets/retry.png"),s.audio("themeSong","assets/themesong.m4a"),s.image("winback","assets/winback.png"),s.image("wintitle","assets/wintitle.png"),s.onLoadComplete.add(a.onLoadComplete,a)}},c.prototype.setProgressLogo=function(){n=a.game,o=a.add,r=o.tileSprite(n.init.gameWidth()/2-90,n.init.gameHeight()/2-90,30,11,"fblogo"),r.scale.x=6,r.scale.y=6,l=o.sprite(n.init.gameWidth()/2-110,n.init.gameHeight()/2,"preloader"),l.cropEnabled=!1,s.setPreloadSprite(l)},c.prototype.onLoadComplete=function(){a.state.start("Menu")},t.exports=c},{}],7:[function(e,t,i){"use strict";var a=function(){};a.prototype={create:function(){this.stage.backgroundColor=3289907,this.menu=this.add.tileSprite(0,0,30,60,"winback"),this.scaleSprite(this.menu),this.menu.inputEnabled=!0,this.title=this.add.tileSprite(0,15*this.game.init.pixelScale,30,5,"wintitle"),this.scaleSprite(this.title),this.title.alpha=0,this.fblogo=this.add.tileSprite(this.game.init.gameWidth()-70,this.game.init.gameHeight()-32,30,11,"fblogo"),this.fblogo.scale.x=2,this.fblogo.scale.y=2},update:function(){this.game.utils.fadeIn(this.title,120,this)}},a.prototype.scaleSprite=function(e){e.scale.x=this.game.init.pixelScale,e.scale.y=this.game.init.pixelScale},t.exports=a},{}],8:[function(e,t,i){"use strict";var a={fadeOut:function(e,t,i){i.game.add.tween(e).to({alpha:0},t,Phaser.Easing.Sinusoidal.InOut,!0,0)},fadeIn:function(e,t,i){i.game.add.tween(e).to({alpha:1},t,Phaser.Easing.Sinusoidal.InOut,!0,0)},tileAnimation:function(e,t){e.tilePosition.x-=t}};t.exports=a},{}]},{},[1]);